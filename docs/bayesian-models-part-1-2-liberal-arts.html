<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Bayesian Models Part 1.2 Liberal Arts | MATH 454 Bayesian Statistics - College Ranking</title>
  <meta name="description" content="Chapter 7 Bayesian Models Part 1.2 Liberal Arts | MATH 454 Bayesian Statistics - College Ranking" />
  <meta name="generator" content="bookdown  and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Bayesian Models Part 1.2 Liberal Arts | MATH 454 Bayesian Statistics - College Ranking" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="zuofuhuang/CollegeRanking" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Bayesian Models Part 1.2 Liberal Arts | MATH 454 Bayesian Statistics - College Ranking" />
  
  
  

<meta name="author" content="Zuofu Huang and Kavya Shetty, Spring 2019 Macalester College" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayesian-models-part-1-1-university.html">
<link rel="next" href="bayesian-models-part-2.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="motivation.html"><a href="motivation.html"><i class="fa fa-check"></i><b>2</b> Motivation</a><ul>
<li class="chapter" data-level="2.1" data-path="motivation.html"><a href="motivation.html#why-this"><i class="fa fa-check"></i><b>2.1</b> Why this?</a></li>
<li class="chapter" data-level="2.2" data-path="motivation.html"><a href="motivation.html#a-snapshot"><i class="fa fa-check"></i><b>2.2</b> A snapshot</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-source.html"><a href="data-source.html"><i class="fa fa-check"></i><b>3</b> Data source</a><ul>
<li class="chapter" data-level="3.1" data-path="data-source.html"><a href="data-source.html#data-that-makes-our-work-possible"><i class="fa fa-check"></i><b>3.1</b> Data that makes our work possible</a></li>
<li class="chapter" data-level="3.2" data-path="data-source.html"><a href="data-source.html#our-data-dictionary"><i class="fa fa-check"></i><b>3.2</b> Our data dictionary</a></li>
<li class="chapter" data-level="3.3" data-path="data-source.html"><a href="data-source.html#changes-to-datasets"><i class="fa fa-check"></i><b>3.3</b> Changes to datasets</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-cleaning.html"><a href="data-cleaning.html"><i class="fa fa-check"></i><b>4</b> Data cleaning</a><ul>
<li class="chapter" data-level="4.1" data-path="data-cleaning.html"><a href="data-cleaning.html#what-did-we-do"><i class="fa fa-check"></i><b>4.1</b> What <strong>did</strong> we do?</a><ul>
<li class="chapter" data-level="4.1.1" data-path="data-cleaning.html"><a href="data-cleaning.html#load-data-select-and-rename-columns"><i class="fa fa-check"></i><b>4.1.1</b> Load data, select and rename columns</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-cleaning.html"><a href="data-cleaning.html#filter-schools-that-have-a-rank"><i class="fa fa-check"></i><b>4.1.2</b> Filter schools that have a rank</a></li>
<li class="chapter" data-level="4.1.3" data-path="data-cleaning.html"><a href="data-cleaning.html#join-datasets"><i class="fa fa-check"></i><b>4.1.3</b> Join datasets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>5</b> Visualization</a><ul>
<li class="chapter" data-level="5.1" data-path="visualization.html"><a href="visualization.html#st-2nd-peeks"><i class="fa fa-check"></i><b>5.1</b> 1st &amp; 2nd Peeks</a></li>
<li class="chapter" data-level="5.2" data-path="visualization.html"><a href="visualization.html#rd-peek"><i class="fa fa-check"></i><b>5.2</b> 3rd Peek</a></li>
<li class="chapter" data-level="5.3" data-path="visualization.html"><a href="visualization.html#th-peek"><i class="fa fa-check"></i><b>5.3</b> 4th Peek</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bayesian-models-part-1-1-university.html"><a href="bayesian-models-part-1-1-university.html"><i class="fa fa-check"></i><b>6</b> Bayesian Models Part 1.1 University</a><ul>
<li class="chapter" data-level="6.1" data-path="bayesian-models-part-1-1-university.html"><a href="bayesian-models-part-1-1-university.html#model-0"><i class="fa fa-check"></i><b>6.1</b> Model 0</a><ul>
<li class="chapter" data-level="6.1.1" data-path="bayesian-models-part-1-1-university.html"><a href="bayesian-models-part-1-1-university.html#first-impression"><i class="fa fa-check"></i><b>6.1.1</b> First Impression</a></li>
<li class="chapter" data-level="6.1.2" data-path="bayesian-models-part-1-1-university.html"><a href="bayesian-models-part-1-1-university.html#building-the-model"><i class="fa fa-check"></i><b>6.1.2</b> Building the model</a></li>
<li class="chapter" data-level="6.1.3" data-path="bayesian-models-part-1-1-university.html"><a href="bayesian-models-part-1-1-university.html#model-summary"><i class="fa fa-check"></i><b>6.1.3</b> Model summary</a></li>
<li class="chapter" data-level="6.1.4" data-path="bayesian-models-part-1-1-university.html"><a href="bayesian-models-part-1-1-university.html#posterior-inference"><i class="fa fa-check"></i><b>6.1.4</b> Posterior inference</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="bayesian-models-part-1-1-university.html"><a href="bayesian-models-part-1-1-university.html#model-1"><i class="fa fa-check"></i><b>6.2</b> Model 1</a><ul>
<li class="chapter" data-level="6.2.1" data-path="bayesian-models-part-1-1-university.html"><a href="bayesian-models-part-1-1-university.html#first-impression-1"><i class="fa fa-check"></i><b>6.2.1</b> First Impression</a></li>
<li class="chapter" data-level="6.2.2" data-path="bayesian-models-part-1-1-university.html"><a href="bayesian-models-part-1-1-university.html#building-the-model-1"><i class="fa fa-check"></i><b>6.2.2</b> Building the model</a></li>
<li class="chapter" data-level="6.2.3" data-path="bayesian-models-part-1-1-university.html"><a href="bayesian-models-part-1-1-university.html#model-summary-1"><i class="fa fa-check"></i><b>6.2.3</b> Model summary</a></li>
<li class="chapter" data-level="6.2.4" data-path="bayesian-models-part-1-1-university.html"><a href="bayesian-models-part-1-1-university.html#posterior-inference-1"><i class="fa fa-check"></i><b>6.2.4</b> Posterior inference</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="bayesian-models-part-1-1-university.html"><a href="bayesian-models-part-1-1-university.html#model-2"><i class="fa fa-check"></i><b>6.3</b> Model 2</a><ul>
<li class="chapter" data-level="6.3.1" data-path="bayesian-models-part-1-1-university.html"><a href="bayesian-models-part-1-1-university.html#first-impression-2"><i class="fa fa-check"></i><b>6.3.1</b> First Impression</a></li>
<li class="chapter" data-level="6.3.2" data-path="bayesian-models-part-1-1-university.html"><a href="bayesian-models-part-1-1-university.html#building-the-model-2"><i class="fa fa-check"></i><b>6.3.2</b> Building the model</a></li>
<li class="chapter" data-level="6.3.3" data-path="bayesian-models-part-1-1-university.html"><a href="bayesian-models-part-1-1-university.html#model-summary-2"><i class="fa fa-check"></i><b>6.3.3</b> Model summary</a></li>
<li class="chapter" data-level="6.3.4" data-path="bayesian-models-part-1-1-university.html"><a href="bayesian-models-part-1-1-university.html#posterior-inference-2"><i class="fa fa-check"></i><b>6.3.4</b> Posterior inference</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="bayesian-models-part-1-1-university.html"><a href="bayesian-models-part-1-1-university.html#future-steps"><i class="fa fa-check"></i><b>6.4</b> Future steps</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="bayesian-models-part-1-2-liberal-arts.html"><a href="bayesian-models-part-1-2-liberal-arts.html"><i class="fa fa-check"></i><b>7</b> Bayesian Models Part 1.2 Liberal Arts</a><ul>
<li class="chapter" data-level="7.1" data-path="bayesian-models-part-1-2-liberal-arts.html"><a href="bayesian-models-part-1-2-liberal-arts.html#model-0-1"><i class="fa fa-check"></i><b>7.1</b> Model 0</a><ul>
<li class="chapter" data-level="7.1.1" data-path="bayesian-models-part-1-2-liberal-arts.html"><a href="bayesian-models-part-1-2-liberal-arts.html#first-impression-3"><i class="fa fa-check"></i><b>7.1.1</b> First Impression</a></li>
<li class="chapter" data-level="7.1.2" data-path="bayesian-models-part-1-2-liberal-arts.html"><a href="bayesian-models-part-1-2-liberal-arts.html#building-the-model-3"><i class="fa fa-check"></i><b>7.1.2</b> Building the model</a></li>
<li class="chapter" data-level="7.1.3" data-path="bayesian-models-part-1-2-liberal-arts.html"><a href="bayesian-models-part-1-2-liberal-arts.html#model-summary-3"><i class="fa fa-check"></i><b>7.1.3</b> Model summary</a></li>
<li class="chapter" data-level="7.1.4" data-path="bayesian-models-part-1-2-liberal-arts.html"><a href="bayesian-models-part-1-2-liberal-arts.html#posterior-inference-3"><i class="fa fa-check"></i><b>7.1.4</b> Posterior inference</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="bayesian-models-part-1-2-liberal-arts.html"><a href="bayesian-models-part-1-2-liberal-arts.html#model-1-1"><i class="fa fa-check"></i><b>7.2</b> Model 1</a></li>
<li class="chapter" data-level="7.3" data-path="bayesian-models-part-1-2-liberal-arts.html"><a href="bayesian-models-part-1-2-liberal-arts.html#model-2-1"><i class="fa fa-check"></i><b>7.3</b> Model 2</a><ul>
<li class="chapter" data-level="7.3.1" data-path="bayesian-models-part-1-2-liberal-arts.html"><a href="bayesian-models-part-1-2-liberal-arts.html#first-impression-4"><i class="fa fa-check"></i><b>7.3.1</b> First Impression</a></li>
<li class="chapter" data-level="7.3.2" data-path="bayesian-models-part-1-2-liberal-arts.html"><a href="bayesian-models-part-1-2-liberal-arts.html#building-the-model-4"><i class="fa fa-check"></i><b>7.3.2</b> Building the model</a></li>
<li class="chapter" data-level="7.3.3" data-path="bayesian-models-part-1-2-liberal-arts.html"><a href="bayesian-models-part-1-2-liberal-arts.html#model-summary-4"><i class="fa fa-check"></i><b>7.3.3</b> Model summary</a></li>
<li class="chapter" data-level="7.3.4" data-path="bayesian-models-part-1-2-liberal-arts.html"><a href="bayesian-models-part-1-2-liberal-arts.html#posterior-inference-4"><i class="fa fa-check"></i><b>7.3.4</b> Posterior inference</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="bayesian-models-part-1-2-liberal-arts.html"><a href="bayesian-models-part-1-2-liberal-arts.html#future-steps-1"><i class="fa fa-check"></i><b>7.4</b> Future steps</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bayesian-models-part-2.html"><a href="bayesian-models-part-2.html"><i class="fa fa-check"></i><b>8</b> Bayesian Models Part 2</a><ul>
<li class="chapter" data-level="8.1" data-path="bayesian-models-part-2.html"><a href="bayesian-models-part-2.html#possible-data-cleaning"><i class="fa fa-check"></i><b>8.1</b> Possible data cleaning?</a></li>
<li class="chapter" data-level="8.2" data-path="bayesian-models-part-2.html"><a href="bayesian-models-part-2.html#on-the-way-to-final-model"><i class="fa fa-check"></i><b>8.2</b> On the way to Final Model</a></li>
<li class="chapter" data-level="8.3" data-path="bayesian-models-part-2.html"><a href="bayesian-models-part-2.html#what-are-we-thinking"><i class="fa fa-check"></i><b>8.3</b> What are we thinking?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="becoming-a-proud-bayesian.html"><a href="becoming-a-proud-bayesian.html"><i class="fa fa-check"></i><b>9</b> Becoming a proud Bayesian</a><ul>
<li class="chapter" data-level="9.1" data-path="becoming-a-proud-bayesian.html"><a href="becoming-a-proud-bayesian.html#university-model"><i class="fa fa-check"></i><b>9.1</b> University Model</a><ul>
<li class="chapter" data-level="9.1.1" data-path="becoming-a-proud-bayesian.html"><a href="becoming-a-proud-bayesian.html#get-some-intuition"><i class="fa fa-check"></i><b>9.1.1</b> Get some intuition</a></li>
<li class="chapter" data-level="9.1.2" data-path="becoming-a-proud-bayesian.html"><a href="becoming-a-proud-bayesian.html#some-additional-intuition"><i class="fa fa-check"></i><b>9.1.2</b> Some additional intuition</a></li>
<li class="chapter" data-level="9.1.3" data-path="becoming-a-proud-bayesian.html"><a href="becoming-a-proud-bayesian.html#building-the-model-5"><i class="fa fa-check"></i><b>9.1.3</b> Building the model</a></li>
<li class="chapter" data-level="9.1.4" data-path="becoming-a-proud-bayesian.html"><a href="becoming-a-proud-bayesian.html#model-summary-5"><i class="fa fa-check"></i><b>9.1.4</b> Model summary</a></li>
<li class="chapter" data-level="9.1.5" data-path="becoming-a-proud-bayesian.html"><a href="becoming-a-proud-bayesian.html#posterior-inference-5"><i class="fa fa-check"></i><b>9.1.5</b> Posterior inference</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="becoming-a-proud-bayesian.html"><a href="becoming-a-proud-bayesian.html#liberal-arts-colleges"><i class="fa fa-check"></i><b>9.2</b> Liberal Arts Colleges</a><ul>
<li class="chapter" data-level="9.2.1" data-path="becoming-a-proud-bayesian.html"><a href="becoming-a-proud-bayesian.html#get-some-intuition-1"><i class="fa fa-check"></i><b>9.2.1</b> Get some intuition</a></li>
<li class="chapter" data-level="9.2.2" data-path="becoming-a-proud-bayesian.html"><a href="becoming-a-proud-bayesian.html#building-the-model-6"><i class="fa fa-check"></i><b>9.2.2</b> Building the model</a></li>
<li class="chapter" data-level="9.2.3" data-path="becoming-a-proud-bayesian.html"><a href="becoming-a-proud-bayesian.html#model-summary-6"><i class="fa fa-check"></i><b>9.2.3</b> Model summary</a></li>
<li class="chapter" data-level="9.2.4" data-path="becoming-a-proud-bayesian.html"><a href="becoming-a-proud-bayesian.html#posterior-inference-6"><i class="fa fa-check"></i><b>9.2.4</b> Posterior inference</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="becoming-a-proud-bayesian.html"><a href="becoming-a-proud-bayesian.html#comparison-and-discussion"><i class="fa fa-check"></i><b>9.3</b> Comparison and discussion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="a-little-shiny.html"><a href="a-little-shiny.html"><i class="fa fa-check"></i><b>10</b> A Little Shiny</a><ul>
<li class="chapter" data-level="10.1" data-path="a-little-shiny.html"><a href="a-little-shiny.html#shiny-app"><i class="fa fa-check"></i><b>10.1</b> Shiny App</a></li>
<li class="chapter" data-level="10.2" data-path="a-little-shiny.html"><a href="a-little-shiny.html#in-case-youre-curious"><i class="fa fa-check"></i><b>10.2</b> In case you’re curious</a><ul>
<li class="chapter" data-level="10.2.1" data-path="a-little-shiny.html"><a href="a-little-shiny.html#code-for-shiny-app-collegeranking"><i class="fa fa-check"></i><b>10.2.1</b> Code for Shiny App “collegeranking”</a></li>
<li class="chapter" data-level="10.2.2" data-path="a-little-shiny.html"><a href="a-little-shiny.html#code-for-shiny-app-universityranking"><i class="fa fa-check"></i><b>10.2.2</b> Code for Shiny App “UniversityRanking”</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MATH 454 Bayesian Statistics - College Ranking</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian-models-part-1.2-liberal-arts" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Bayesian Models Part 1.2 Liberal Arts</h1>
<p><strong>The real question:</strong> why do we repeat the process on liberal arts colleges again?</p>
<p><strong>Answer:</strong> Liberal arts colleges fall under an entirely separate ranking list and often have different characteristics (e.g. size and location, private vs public). We repeat the process to observe the similarity and differences between universities and liberal arts colleges.</p>
<div id="model-0-1" class="section level2">
<h2><span class="header-section-number">7.1</span> Model 0</h2>
<p>Ranking by one year of SAT score: with intuition from <span class="math inline">\(\text{hist}(\sqrt{1/rgamma(10000,a,b)})\)</span>.</p>
<div id="first-impression-3" class="section level3">
<h3><span class="header-section-number">7.1.1</span> First Impression</h3>
<p><img src="CollegeRanking_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>It appears to be a linear relationship!</p>
</div>
<div id="building-the-model-3" class="section level3">
<h3><span class="header-section-number">7.1.2</span> Building the model</h3>
<p>Let <span class="math inline">\(Y_i\)</span> denote the predicted ranking of a liberal arts college in Year 2018. <span class="math inline">\(Y_i\)</span> is predicted by</p>
<p><span class="math display">\[X_i = \text{student mean SAT score of Year 2016-17}\]</span></p>
<p>Our model can be written as:</p>
<p><span class="math display">\[\begin{align} Y_i &amp; \sim N(\beta_0 + \beta_1X_i,\tau_0) \\ 
\beta_0 &amp; \sim N(300,250000^{-1}) \\ 
\beta_1 &amp; \sim N(0,100^{-1}) \\ 
\tau_0 &amp; \sim Gamma(7,4000) \end{align}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># DEFINE the model</span>
liberal_model_<span class="dv">0</span> &lt;-<span class="st"> &quot;model{</span>
<span class="st">    for(i in 1:length(y)) {</span>
<span class="st">        # Data model</span>
<span class="st">        y[i] ~ dnorm(beta0 + beta1 * x[i], tau0)</span>
<span class="st">    }</span>

<span class="st">    # Priors for theta</span>
<span class="st">    beta0 ~ dnorm(300,1/250000)</span>
<span class="st">    beta1 ~ dnorm(0, 1/100)</span>
<span class="st">    tau0 ~ dgamma(7,4000)</span>

<span class="st">}&quot;</span>


<span class="co"># COMPILE the model</span>
model_data4 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">y =</span> full_LiberalArts<span class="op">$</span>Y2018, <span class="dt">x =</span> full_LiberalArts<span class="op">$</span>SAT_AVG_<span class="dv">1617</span>)
model_data4 &lt;-<span class="st"> </span><span class="kw">na.omit</span>(model_data4)

liberal_jags_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">jags.model</span>(<span class="kw">textConnection</span>(liberal_model_<span class="dv">0</span>), 
    <span class="dt">data =</span> <span class="kw">list</span>(<span class="dt">y =</span> model_data4<span class="op">$</span>y, <span class="dt">x =</span> model_data4<span class="op">$</span>x),
    <span class="dt">inits =</span> <span class="kw">list</span>(<span class="dt">.RNG.name =</span> <span class="st">&quot;base::Wichmann-Hill&quot;</span>, <span class="dt">.RNG.seed =</span> <span class="dv">454</span>))</code></pre></div>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 101
##    Unobserved stochastic nodes: 3
##    Total graph size: 396
## 
## Initializing model</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># SIMULATE the model</span>
liberal_sim_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">coda.samples</span>(liberal_jags_<span class="dv">0</span>,
    <span class="dt">variable.names =</span> <span class="kw">c</span>(<span class="st">&quot;beta0&quot;</span>, <span class="st">&quot;beta1&quot;</span>, <span class="st">&quot;tau0&quot;</span>),
    <span class="dt">n.iter =</span> <span class="dv">10000</span>)

<span class="co"># STORE the chains in a data frame</span>
liberal_chains_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">data.frame</span>(liberal_sim_<span class="dv">0</span>[[<span class="dv">1</span>]])</code></pre></div>
</div>
<div id="model-summary-3" class="section level3">
<h3><span class="header-section-number">7.1.3</span> Model summary</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(liberal_sim_<span class="dv">0</span>)</code></pre></div>
<pre><code>## 
## Iterations = 1:10000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 10000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##            Mean        SD  Naive SE Time-series SE
## beta0 -0.614922 1.583e+01 1.583e-01      2.144e+00
## beta1  0.021724 1.296e-02 1.296e-04      1.767e-03
## tau0   0.003849 5.113e-04 5.113e-06      5.914e-06
## 
## 2. Quantiles for each variable:
## 
##             2.5%        25%       50%       75%     97.5%
## beta0 -31.655750 -11.608615 -1.094746 10.751901 29.460108
## beta1  -0.003149   0.012368  0.022064  0.030707  0.047298
## tau0    0.002903   0.003495  0.003829  0.004177  0.004907</code></pre>
</div>
<div id="posterior-inference-3" class="section level3">
<h3><span class="header-section-number">7.1.4</span> Posterior inference</h3>
<p>For an unknown liberal arts college with a mean student SAT score of 1450 (e.g. Bvictor College), we could predict its ranking from our rjags simulation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">liberal_chains_<span class="dv">0</span> &lt;-<span class="st"> </span>liberal_chains_<span class="dv">0</span> <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ranking_new =</span> <span class="kw">rnorm</span>(<span class="dv">10000</span>, <span class="dt">mean =</span> beta0 <span class="op">+</span><span class="st"> </span>beta1<span class="op">*</span><span class="dv">1450</span>, <span class="dt">sd =</span> (<span class="dv">1</span><span class="op">/</span>tau0)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">liberal_chains_<span class="dv">0</span> <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="kw">quantile</span>(ranking_new,<span class="fl">0.025</span>),<span class="kw">quantile</span>(ranking_new,<span class="fl">0.975</span>))</code></pre></div>
<pre><code>##   quantile(ranking_new, 0.025) quantile(ranking_new, 0.975)
## 1                    -1.732125                     63.32857</code></pre>
<p>A <span class="math inline">\(95\%\)</span> credible interval is <span class="math inline">\((-1,63)\)</span>. Due to restrictions of this one-predictor model, we expect to see an improvement in later models.</p>
</div>
</div>
<div id="model-1-1" class="section level2">
<h2><span class="header-section-number">7.2</span> Model 1</h2>
<p>Ranking by three years of SAT score. This is the best Bayesian model one can ever come up with.</p>
<p> </p>
<p><strong>Just Kidding.</strong></p>
<p> </p>
<p>As we discussed earlier in Chapter 6, Model 1 is overwhelmingly multicollinear; Model 1 is a sufficient sustitute if we want to look at the relationship between ranking and SAT score.</p>
</div>
<div id="model-2-1" class="section level2">
<h2><span class="header-section-number">7.3</span> Model 2</h2>
<p>2018 U.S. News Ranking by average SAT score and admissions rate of Year 2017.</p>
<div id="first-impression-4" class="section level3">
<h3><span class="header-section-number">7.3.1</span> First Impression</h3>
<p><img src="CollegeRanking_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p>There’s a strong positive relationship between the admission rate of colleges and college ranking (a larger number in college ranking is <em>worse</em>). From color gradient of points, we can see that schools with higher SAT averages tend to be better ranked.</p>
</div>
<div id="building-the-model-4" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Building the model</h3>
<div id="step-1-1" class="section level4">
<h4><span class="header-section-number">7.3.2.1</span> Step 1</h4>
<p>A linear model provides some intuition about how the priors might be constructed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(<span class="kw">lm</span>(full_LiberalArts<span class="op">$</span>Y2018 <span class="op">~</span><span class="st"> </span>full_LiberalArts<span class="op">$</span>SAT_AVG_<span class="dv">1617</span> <span class="op">+</span><span class="st"> </span>full_LiberalArts<span class="op">$</span>ADM_RATE_<span class="dv">1617</span>))</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = full_LiberalArts$Y2018 ~ full_LiberalArts$SAT_AVG_1617 + 
##     full_LiberalArts$ADM_RATE_1617)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -50.679  -9.613  -0.042  10.169  59.538 
## 
## Coefficients:
##                                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                    430.23894   34.40379  12.506   &lt;2e-16 ***
## full_LiberalArts$SAT_AVG_1617   -0.30402    0.02336 -13.012   &lt;2e-16 ***
## full_LiberalArts$ADM_RATE_1617  37.57722   13.59032   2.765   0.0068 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 19.48 on 98 degrees of freedom
##   (48 observations deleted due to missingness)
## Multiple R-squared:  0.8577, Adjusted R-squared:  0.8548 
## F-statistic: 295.3 on 2 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="step-2-1" class="section level4">
<h4><span class="header-section-number">7.3.2.2</span> Step 2</h4>
<p>Next, we construct a <strong>hierarchical</strong> model of</p>
<p><span class="math display">\[Y_i = \text{the predicted 2018 ranking of a liberal arts college}\]</span></p>
<p>by</p>
<p><span class="math display">\[\begin{align} X_{1i} &amp; = \text{student mean SAT score of Year 2016-17} \\ 
X_{2i} &amp; = \text{admissions rate during Year 2016-17} \end{align}\]</span></p>
<p><span class="math display">\[\begin{align} Y_i &amp; \sim N(\beta_{0i} + \beta_{1i}X_{1i} + \beta_{2i}X_{2i},\tau_{\text{big}[i]}) \\ 
\beta_{0i} &amp; \sim N(b_0,\tau_0) \\ 
\beta_{1i} &amp; \sim N(b_1,\tau_1) \\ 
\beta_{2i} &amp; \sim N(b_2,\tau_2) \\ 
\tau_{\text{big}[i]} &amp; \sim Gamma(s,r) \\
b_0 &amp; \sim N(180,4000^{-1}) \\ 
\tau_0 &amp; \sim N(30, 1/9) \\ 
b_1 &amp; \sim N(-0.1,0.001^{-1}) \\ 
\tau_1 &amp; \sim N(1000, 0.001^{-1}) \\ 
b_2 &amp; \sim N(80,100^{-1}) \\ 
\tau_2 &amp; \sim N(10, 1) \\ 
s &amp; \sim N(7,1) \\ 
r &amp; \sim N(10000, 10000^{-1}) \end{align}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">liberal_model_<span class="dv">2</span> &lt;-<span class="st"> &quot;model{  </span>
<span class="st">    # Data: observations</span>
<span class="st">    for(i in 1:length(y)) {</span>
<span class="st">        y[i] ~ dnorm(beta0[i] + beta1[i]*x1[i] + beta2[i]*x2[i], tau_big[i])</span>

<span class="st">        # Data: subjects</span>
<span class="st">        beta0[i] ~ dnorm(b0, tau0)</span>
<span class="st">        beta1[i] ~ dnorm(b1,tau1)</span>
<span class="st">        beta2[i] ~ dnorm(b2,tau2)</span>
<span class="st">        tau_big[i] ~ dgamma(s,r)</span>
<span class="st">    }</span>

<span class="st">    # Hyperpriors</span>
<span class="st">    b0 ~ dnorm(180,1/4000)</span>
<span class="st">    tau0 ~ dnorm(30, 1/9)</span>
<span class="st">    b1 ~ dnorm(-0.1,1000)</span>
<span class="st">    tau1 ~ dnorm(1000,1000) </span>
<span class="st">    b2 ~ dnorm(80,1/100)</span>
<span class="st">    tau2 ~ dnorm(10,1)</span>
<span class="st">    s ~ dnorm(7,1)</span>
<span class="st">    r ~ dnorm(10000, 1/10000)</span>
<span class="st">}&quot;</span>

<span class="co"># COMPILE</span>

y &lt;-<span class="st"> </span>full_LiberalArts<span class="op">$</span>Y2018

model_data5 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(y, <span class="dt">x1 =</span> full_LiberalArts<span class="op">$</span>SAT_AVG_<span class="dv">1617</span>, <span class="dt">x2 =</span> full_LiberalArts<span class="op">$</span>ADM_RATE_<span class="dv">1617</span>))
model_data5 &lt;-<span class="st"> </span><span class="kw">na.omit</span>(model_data5)

liberal_jags_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">jags.model</span>(<span class="kw">textConnection</span>(liberal_model_<span class="dv">2</span>), 
    <span class="dt">data =</span> <span class="kw">list</span>(<span class="dt">y =</span> model_data5<span class="op">$</span>y, <span class="dt">x1 =</span> model_data5<span class="op">$</span>x1, <span class="dt">x2 =</span> model_data5<span class="op">$</span>x2),
    <span class="dt">inits=</span><span class="kw">list</span>(<span class="dt">.RNG.name =</span> <span class="st">&quot;base::Wichmann-Hill&quot;</span>, <span class="dt">.RNG.seed =</span> <span class="dv">454</span>))</code></pre></div>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 101
##    Unobserved stochastic nodes: 412
##    Total graph size: 1035
## 
## Initializing model</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># SIMULATE the model</span>
liberal_sim_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">coda.samples</span>(liberal_jags_<span class="dv">2</span>,
    <span class="dt">variable.names =</span> <span class="kw">c</span>(<span class="st">&quot;b0&quot;</span>,<span class="st">&quot;tau0&quot;</span>,<span class="st">&quot;b1&quot;</span>,<span class="st">&quot;tau1&quot;</span>,<span class="st">&quot;b2&quot;</span>,<span class="st">&quot;tau2&quot;</span>,<span class="st">&quot;s&quot;</span>,<span class="st">&quot;r&quot;</span>),
    <span class="dt">n.iter =</span> <span class="dv">10000</span>)

<span class="co"># STORE the chains in a data frame</span>
liberal_chains_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">data.frame</span>(liberal_sim_<span class="dv">2</span>[[<span class="dv">1</span>]])</code></pre></div>
</div>
</div>
<div id="model-summary-4" class="section level3">
<h3><span class="header-section-number">7.3.3</span> Model summary</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(liberal_sim_<span class="dv">2</span>)</code></pre></div>
<pre><code>## 
## Iterations = 1001:11000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 10000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##            Mean       SD  Naive SE Time-series SE
## b0     178.4834  0.56301 0.0056301      0.1895714
## b1      -0.1090  0.02947 0.0002947      0.0039424
## b2      43.1793  5.95589 0.0595589      4.0299101
## r    10016.5430 99.18842 0.9918842      1.2203209
## s        0.1517  0.01632 0.0001632      0.0009056
## tau0    30.1001  3.00404 0.0300404      0.0510047
## tau1   999.9994  0.03244 0.0003244      0.0004133
## tau2    10.0017  1.01154 0.0101154      0.0176700
## 
## 2. Quantiles for each variable:
## 
##           2.5%       25%        50%        75%      97.5%
## b0    177.2556  178.0642   178.5477  1.789e+02  1.793e+02
## b1     -0.1706   -0.1287    -0.1086 -8.759e-02 -5.609e-02
## b2     33.4737   38.3188    42.4722  4.779e+01  5.528e+01
## r    9819.6765 9950.7472 10016.6172  1.008e+04  1.022e+04
## s       0.1220    0.1402     0.1511  1.627e-01  1.850e-01
## tau0   24.2727   28.0611    30.0777  3.214e+01  3.610e+01
## tau1  999.9360  999.9776   999.9993  1.000e+03  1.000e+03
## tau2    8.0292    9.3206     9.9837  1.067e+01  1.202e+01</code></pre>
</div>
<div id="posterior-inference-4" class="section level3">
<h3><span class="header-section-number">7.3.4</span> Posterior inference</h3>
<p>For an unknown Liberal Arts College with student mean SAT score of 1450 and an admission rate of <span class="math inline">\(30\%\)</span> (e.g. Dvictor college), we could predict its ranking from our rjags simulation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">liberal_chains_<span class="dv">2</span> &lt;-<span class="st"> </span>liberal_chains_<span class="dv">2</span> <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">beta0_new =</span> <span class="kw">rnorm</span>(<span class="dv">10000</span>,b0,(<span class="dv">1</span><span class="op">/</span>tau0)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))) <span class="op">%&gt;%</span>
<span class="st">           </span><span class="kw">mutate</span>(<span class="dt">beta1_new =</span> <span class="kw">rnorm</span>(<span class="dv">10000</span>,b1,(<span class="dv">1</span><span class="op">/</span>tau1)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))) <span class="op">%&gt;%</span>
<span class="st">           </span><span class="kw">mutate</span>(<span class="dt">beta2_new =</span> <span class="kw">rnorm</span>(<span class="dv">10000</span>,b2,(<span class="dv">1</span><span class="op">/</span>tau2)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))) <span class="op">%&gt;%</span>
<span class="st">           </span><span class="kw">mutate</span>(<span class="dt">tau_big_new =</span> <span class="kw">rgamma</span>(<span class="dv">10000</span>,s,r)) <span class="op">%&gt;%</span>
<span class="st">           </span><span class="kw">mutate</span>(<span class="dt">ranking_new =</span> <span class="kw">rnorm</span>(<span class="dv">10000</span>, <span class="dt">mean =</span> beta0_new <span class="op">+</span><span class="st"> </span>beta1_new <span class="op">*</span><span class="st"> </span><span class="dv">1450</span> <span class="op">+</span><span class="st"> </span>beta2_new <span class="op">*</span><span class="st"> </span><span class="fl">0.3</span>, <span class="dt">sd =</span> (<span class="dv">1</span><span class="op">/</span>tau_big_new)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">liberal_chains_<span class="dv">2</span> <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="kw">quantile</span>(ranking_new,<span class="fl">0.025</span>),<span class="kw">quantile</span>(ranking_new,<span class="fl">0.975</span>))</code></pre></div>
<pre><code>##   quantile(ranking_new, 0.025) quantile(ranking_new, 0.975)
## 1                     -1721919                      1850909</code></pre>
<p>A <span class="math inline">\(95\%\)</span> credible interval is <strong>not pretty!</strong> This means that we over-evaluate the variability of a lot of predictors.</p>
</div>
</div>
<div id="future-steps-1" class="section level2">
<h2><span class="header-section-number">7.4</span> Future steps</h2>
<p>Given the problem that we encounter at Dvictor College, we also need to pay attention to narrowing the variability in our Bayesian models. (which really teaches us a lesson: simple is good; a complicated hierarchical model is not always helpful!)</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayesian-models-part-1-1-university.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayesian-models-part-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
